# Langfuse 国际化 (i18n) 支持

为 Langfuse 添加中英文国际化支持，支持运行时语言切换，英文为默认语言。

## 功能特性

- ✅ 支持中文 (zh) 和英文 (en)
- ✅ 运行时语言切换，无需刷新页面
- ✅ 语言偏好持久化 (localStorage)
- ✅ 导航菜单国际化
- ✅ 设置页面语言切换入口

## 文件结构

```
web/src/
├── i18n.ts                          # 语言配置
├── locales/
│   ├── en.json                      # 英文翻译
│   └── zh.json                      # 中文翻译
├── features/i18n/
│   ├── index.ts                     # 导出入口
│   ├── I18nProvider.tsx             # React Context Provider
│   ├── LanguageSwitcher.tsx         # 语言切换组件
│   ├── AppearanceSettings.tsx       # 外观设置页面
│   └── useTranslatedRoutes.ts       # 路由翻译 Hook
└── pages/
    ├── _app.tsx                     # 集成 I18nProvider
    └── project/[projectId]/settings/index.tsx  # 添加 Appearance 设置
```

## 使用方法

### 在组件中使用翻译

```tsx
import { useTranslation } from "@/src/features/i18n";

function MyComponent() {
  const { t, locale, setLocale } = useTranslation();
  
  return (
    <div>
      <h1>{t("navigation.home")}</h1>
      <p>当前语言: {locale}</p>
      <button onClick={() => setLocale("zh")}>切换到中文</button>
    </div>
  );
}
```

### 添加新的翻译键

1. 在 `src/locales/en.json` 添加英文翻译：

```json
{
  "myFeature": {
    "title": "My Feature",
    "description": "This is my feature"
  }
}
```

2. 在 `src/locales/zh.json` 添加中文翻译：

```json
{
  "myFeature": {
    "title": "我的功能",
    "description": "这是我的功能"
  }
}
```

3. 在组件中使用：

```tsx
const { t } = useTranslation();
<h1>{t("myFeature.title")}</h1>
```

## 翻译键命名规范

| 前缀 | 用途 | 示例 |
|------|------|------|
| `navigation.*` | 导航菜单项 | `navigation.home` |
| `groups.*` | 导航分组名称 | `groups.observability` |
| `common.*` | 通用 UI 文本 | `common.loading` |
| `errors.*` | 错误消息 | `errors.projectNotFound` |
| `settings.*` | 设置页面 | `settings.language` |

## 语言切换入口

用户可在 **Project Settings → Appearance** 页面切换语言。

## 技术实现

### I18nProvider

使用 React Context 管理语言状态：

- `locale`: 当前语言
- `setLocale`: 设置语言函数
- `t`: 翻译函数

### 持久化

语言选择保存在 `localStorage`，键名 `langfuse-locale`。

### Hydration 安全

Provider 在客户端挂载前使用默认语言 (en)，避免 SSR hydration 不匹配。

## 后续扩展

以下组件可继续添加翻译支持：

- [ ] 布局组件错误消息
- [ ] 认证相关页面
- [ ] 表单验证消息
- [ ] 表格列标题
- [ ] 弹窗和通知
- [ ] 帮助文档链接

## 贡献指南

1. 添加新翻译时，请同时更新 `en.json` 和 `zh.json`
2. 使用嵌套结构组织相关翻译键
3. 保持键名简洁且语义化
4. 测试语言切换功能确保翻译正确显示
